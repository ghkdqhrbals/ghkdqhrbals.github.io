<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="실시간 채팅방 구현(7) - (수정된 아키텍처)" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="진행상황 Architecture 현재 구현된 서비스를 docker compose를 통해 실행시키면 다음과 같이 컨테이너들이 생긴다. Kafka와 Chat Server, Auth Server, DB들 모두 외부접속 가능하도록 노출 port를 도커 내부 포트랑 같게 설정했다. 1 2 3 4 5 6 7 8 9 10 11 12 13 gyuminhwangbo@Gyuminui-MacBookPro spring-chatting-server % docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES d54365955efa spring-chatting-server_nginx &quot;/docker-entrypoint.…&quot; 51 seconds ago Up 47 seconds 0.0.0.0:8080-&gt;80/tcp nginx af5c00d411db spring-chatting-server_chatting-server-2 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8084-&gt;8084/tcp chatting-server-2 becb35e0bc1f spring-chatting-server_chatting-server-1 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8083-&gt;8083/tcp chatting-server-1 9bfb2b8d53ca confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8099-&gt;8099/tcp, 9092/tcp kafka3 cc8d6c5944b3 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8097-&gt;8097/tcp, 9092/tcp kafka1 995e41051907 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8098-&gt;8098/tcp, 9092/tcp kafka2 7d355211b1ce spring-chatting-server_auth-server &quot;java -jar app.jar&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8085-&gt;8085/tcp auth-server 29ab743b9847 confluentinc/cp-zookeeper:7.2.1 &quot;/etc/confluent/dock…&quot; 52 seconds ago Up 50 seconds 2181/tcp, 2888/tcp, 3888/tcp zookeeper 722bf2b27df5 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5434-&gt;5434/tcp chatting-db-2 ccc3e138004a postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5433-&gt;5433/tcp chatting-db-1 3a52283f6f52 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5435-&gt;5435/tcp auth-db" /><meta property="og:description" content="진행상황 Architecture 현재 구현된 서비스를 docker compose를 통해 실행시키면 다음과 같이 컨테이너들이 생긴다. Kafka와 Chat Server, Auth Server, DB들 모두 외부접속 가능하도록 노출 port를 도커 내부 포트랑 같게 설정했다. 1 2 3 4 5 6 7 8 9 10 11 12 13 gyuminhwangbo@Gyuminui-MacBookPro spring-chatting-server % docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES d54365955efa spring-chatting-server_nginx &quot;/docker-entrypoint.…&quot; 51 seconds ago Up 47 seconds 0.0.0.0:8080-&gt;80/tcp nginx af5c00d411db spring-chatting-server_chatting-server-2 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8084-&gt;8084/tcp chatting-server-2 becb35e0bc1f spring-chatting-server_chatting-server-1 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8083-&gt;8083/tcp chatting-server-1 9bfb2b8d53ca confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8099-&gt;8099/tcp, 9092/tcp kafka3 cc8d6c5944b3 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8097-&gt;8097/tcp, 9092/tcp kafka1 995e41051907 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8098-&gt;8098/tcp, 9092/tcp kafka2 7d355211b1ce spring-chatting-server_auth-server &quot;java -jar app.jar&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8085-&gt;8085/tcp auth-server 29ab743b9847 confluentinc/cp-zookeeper:7.2.1 &quot;/etc/confluent/dock…&quot; 52 seconds ago Up 50 seconds 2181/tcp, 2888/tcp, 3888/tcp zookeeper 722bf2b27df5 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5434-&gt;5434/tcp chatting-db-2 ccc3e138004a postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5433-&gt;5433/tcp chatting-db-1 3a52283f6f52 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5435-&gt;5435/tcp auth-db" /><link rel="canonical" href="/posts/chatting(7)/" /><meta property="og:url" content="/posts/chatting(7)/" /><meta property="og:site_name" content="Austin" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-30T00:00:25+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="실시간 채팅방 구현(7) - (수정된 아키텍처)" /><meta name="twitter:site" content="@ghkdqhrbals" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-29T08:19:41+00:00","datePublished":"2022-12-30T00:00:25+00:00","description":"진행상황 Architecture 현재 구현된 서비스를 docker compose를 통해 실행시키면 다음과 같이 컨테이너들이 생긴다. Kafka와 Chat Server, Auth Server, DB들 모두 외부접속 가능하도록 노출 port를 도커 내부 포트랑 같게 설정했다. 1 2 3 4 5 6 7 8 9 10 11 12 13 gyuminhwangbo@Gyuminui-MacBookPro spring-chatting-server % docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES d54365955efa spring-chatting-server_nginx &quot;/docker-entrypoint.…&quot; 51 seconds ago Up 47 seconds 0.0.0.0:8080-&gt;80/tcp nginx af5c00d411db spring-chatting-server_chatting-server-2 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8084-&gt;8084/tcp chatting-server-2 becb35e0bc1f spring-chatting-server_chatting-server-1 &quot;java -jar app.jar&quot; 51 seconds ago Up 48 seconds 0.0.0.0:8083-&gt;8083/tcp chatting-server-1 9bfb2b8d53ca confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8099-&gt;8099/tcp, 9092/tcp kafka3 cc8d6c5944b3 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8097-&gt;8097/tcp, 9092/tcp kafka1 995e41051907 confluentinc/cp-kafka:7.2.1 &quot;/etc/confluent/dock…&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8098-&gt;8098/tcp, 9092/tcp kafka2 7d355211b1ce spring-chatting-server_auth-server &quot;java -jar app.jar&quot; 51 seconds ago Up 49 seconds 0.0.0.0:8085-&gt;8085/tcp auth-server 29ab743b9847 confluentinc/cp-zookeeper:7.2.1 &quot;/etc/confluent/dock…&quot; 52 seconds ago Up 50 seconds 2181/tcp, 2888/tcp, 3888/tcp zookeeper 722bf2b27df5 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5434-&gt;5434/tcp chatting-db-2 ccc3e138004a postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5433-&gt;5433/tcp chatting-db-1 3a52283f6f52 postgres:12-alpine &quot;docker-entrypoint.s…&quot; 52 seconds ago Up 50 seconds 5432/tcp, 0.0.0.0:5435-&gt;5435/tcp auth-db","headline":"실시간 채팅방 구현(7) - (수정된 아키텍처)","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/chatting(7)/"},"url":"/posts/chatting(7)/"}</script><title>실시간 채팅방 구현(7) - (수정된 아키텍처) | Austin</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Austin"><meta name="application-name" content="Austin"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Austin</a></div><div class="site-subtitle font-italic"> Record every seconds</div><div class="site-subtitle"> <a href="https://ghkdqhrbals.github.io/portfolios/" class="mx-auto" style="color: #ffd700"> See my portfolio </a></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ghkdqhrbals" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ghkdqhrbals','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>실시간 채팅방 구현(7) - (수정된 아키텍처)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>실시간 채팅방 구현(7) - (수정된 아키텍처)</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1672358425" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-12-30 </em> </span> <span> 업데이트 <em class="" data-ts="1674980381" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-01-29 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ghkdqhrbals">ghkdqhrbals</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1909 단어"> <em>10 분</em>읽는 시간</span></div></div></div><div class="post-content"><h2 id="진행상황"><span class="mr-2">진행상황</span><a href="#진행상황" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="architecture"><span class="mr-2">Architecture</span><a href="#architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="../../assets/img/kafka/implement.png" alt="img" data-proofer-ignore> 현재 구현된 서비스를 docker compose를 통해 실행시키면 다음과 같이 컨테이너들이 생긴다.</p><blockquote><p>Kafka와 Chat Server, Auth Server, DB들 모두 외부접속 가능하도록 노출 port를 도커 내부 포트랑 같게 설정했다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>gyuminhwangbo@Gyuminui-MacBookPro spring-chatting-server % docker ps
CONTAINER ID   IMAGE                                      COMMAND                  CREATED          STATUS          PORTS                              NAMES
d54365955efa   spring-chatting-server_nginx               "/docker-entrypoint.…"   51 seconds ago   Up 47 seconds   0.0.0.0:8080-&gt;80/tcp               nginx
af5c00d411db   spring-chatting-server_chatting-server-2   "java -jar app.jar"      51 seconds ago   Up 48 seconds   0.0.0.0:8084-&gt;8084/tcp             chatting-server-2
becb35e0bc1f   spring-chatting-server_chatting-server-1   "java -jar app.jar"      51 seconds ago   Up 48 seconds   0.0.0.0:8083-&gt;8083/tcp             chatting-server-1
9bfb2b8d53ca   confluentinc/cp-kafka:7.2.1                "/etc/confluent/dock…"   51 seconds ago   Up 49 seconds   0.0.0.0:8099-&gt;8099/tcp, 9092/tcp   kafka3
cc8d6c5944b3   confluentinc/cp-kafka:7.2.1                "/etc/confluent/dock…"   51 seconds ago   Up 49 seconds   0.0.0.0:8097-&gt;8097/tcp, 9092/tcp   kafka1
995e41051907   confluentinc/cp-kafka:7.2.1                "/etc/confluent/dock…"   51 seconds ago   Up 49 seconds   0.0.0.0:8098-&gt;8098/tcp, 9092/tcp   kafka2
7d355211b1ce   spring-chatting-server_auth-server         "java -jar app.jar"      51 seconds ago   Up 49 seconds   0.0.0.0:8085-&gt;8085/tcp             auth-server
29ab743b9847   confluentinc/cp-zookeeper:7.2.1            "/etc/confluent/dock…"   52 seconds ago   Up 50 seconds   2181/tcp, 2888/tcp, 3888/tcp       zookeeper
722bf2b27df5   postgres:12-alpine                         "docker-entrypoint.s…"   52 seconds ago   Up 50 seconds   5432/tcp, 0.0.0.0:5434-&gt;5434/tcp   chatting-db-2
ccc3e138004a   postgres:12-alpine                         "docker-entrypoint.s…"   52 seconds ago   Up 50 seconds   5432/tcp, 0.0.0.0:5433-&gt;5433/tcp   chatting-db-1
3a52283f6f52   postgres:12-alpine                         "docker-entrypoint.s…"   52 seconds ago   Up 50 seconds   5432/tcp, 0.0.0.0:5435-&gt;5435/tcp   auth-db
</pre></table></code></div></div></blockquote><h3 id="구현-완료"><span class="mr-2">구현 완료</span><a href="#구현-완료" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>API GATEWAY<ul><li>채팅서버(/chat)에 접속 시, ip_hash로 특정 서버로만 들어가도록 구현<li>인증서버(/user)에 접속할 때 uri 맨 뒤 <code class="language-plaintext highlighter-rouge">/</code>가 붙어야만 접속되었었다. 그래서 <code class="language-plaintext highlighter-rouge">rewrite {regex}</code>로 맨뒤에 자동으로 <code class="language-plaintext highlighter-rouge">/</code>를 붙여주도록 설정</ul><li>Auth Server<ul><li>인증서버를 따로 구현함으로써 다른 곳에서도 편하게 이용할 수 있도록 구현</ul><li>Chat Server<ul><li>채팅서버를 수동으로 2대 구축<blockquote><p>추후 K8S의 auto-scaling으로 구현할 예정</p></blockquote></ul><li>Kafka Broker<ul><li>토픽은 두 개로 올렸으며, 각각 broker 3대 및 2개의 파티션에 걸쳐 백업되도록 운용<blockquote><p>파티션은 200개가 적당하다고 한다. 지금 당장은 2개의 파티션으로 운용.</p></blockquote></ul></ul><h3 id="구현-미완료"><span class="mr-2">구현 미완료</span><a href="#구현-미완료" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Front Server<ul><li>API GATEWAY에 비동기+논 블로킹 webClient로 요청 전송 예정</ul><li>Log Server<ul><li>DB선정에 있어 고민이 있다. 여러가지 비교해봤을 때, 1차적으로 Elastic Search을 선택하였다. <a href="https://www.reddit.com/r/Database/comments/w8eb0g/best_db_for_logging/">시계열 데이터에 맞는 DB는?</a><blockquote><ul><li><strong>Elastic Search</strong> = RESTful api기반으로 여러 곳에서 활용 가능하며, 역색인을 지원하므로 비정형 doc 색인/검색에 탁월하다. 필자는 채팅을 관찰하며 특정 단어의 빈도수를 모니터링하려 하는데 이때 쓰기 딱 좋을듯. 또한 데이터 저장 시점에 해당 데이터를 색인하기에 실시간이 아닌점이 마음에 든다. Kafka를 쓰기때문에 실시간이 아닐 뿐더러, Logging에 실시간성이 필요없기때문에 알맞은 엔진이라고 생각된다.<li><strong>HDFS</strong> = 분산저장 아직 하지 않을것임<li><strong>File System</strong> = Transaction관리가 어려움<li><strong>Timescale</strong> = 기존 Postgres를 시계열로 확장시킨 DB. 그래서 익숙한 SQL문을 그대로 사용할 수 있다는 장점이 있다. 하지만 <strong>단점은 직접 모든 SQL문을 작성해야한다</strong>는 점이다(이유는 JPA에서 Timescale을 지원하지 않기 때문에 모든 Dialect를 작성해야함)<li><strong>InfluxDB</strong> = 가장 많이 사용하는 시계열 DB이자, JPA가 지원하는 시계열 DB. <a href="https://geekflare.com/time-series-database/">참고자료</a>. 필자가 원하는 채팅개수 및 신규가입자 수라는 시계열 데이터들을 대시보드로 별도로 쉽게 확인할 수 있다.</ul><p><strong>InfluxDB</strong>는 real-time querying에 좋다고 하는것 같은데, 우리는 카프카를 사용하기때문에 해당 장점을 활용하지 않는다.</p></blockquote><li>만약 InfluxDB를 선택한다면, 시계열데이터는 다음과 같이 두 가지로 각각의 하이퍼테이블을 구성할 예정<ul><li>symbol = chatAdd, data = 채팅 입력 수<li>symbol = userAdd, data = 신규가입자 수</ul></ul><li>Orchestration saga<ul><li>필자는 Kafka를 MSA의 백본망으로 사용한다. 따라서 <a href="https://ghkdqhrbals.github.io/posts/micro-service-architecture1">saga</a>의 패턴 중 중앙집권형인 Orchestration 패턴으로 모니터링을 중앙에서 할 것이다.<li>사용할 모니터링 툴 리스트<ul><li>메세지 모니터링 <a href="https://github.com/provectus/kafka-ui">UI for Kafka</a><blockquote><p><img data-src="../../assets/img/kafka/1.png" alt="img1" data-proofer-ignore></p><p><img data-src="../../assets/img/kafka/2.png" alt="img2" data-proofer-ignore> 카프카 서버 연결 및 Consumer Group 확인/ 토픽 확인이 용이하다. 또한 실제 메세지 내용도 확인할 수 있어서 편리하다.</p></blockquote><li>Consumer 트래픽 모니터링 <a href="https://s262701-id.tistory.com/126">https://s262701-id.tistory.com/126</a><blockquote><ul><li>Linkedin의 <strong>burrow</strong><li>lag정보 <strong>Elasticsearch</strong> 수집 데이터파이프라인<li>ElasticSearch에 기록된 lag 정보 기반 <strong>Grafana</strong> lag 모니터링 대시보드 <a href="https://towardsdatascience.com/overview-of-ui-tools-for-monitoring-and-management-of-apache-kafka-clusters-8c383f897e80">각각의 Kafka 모니터링 툴 비교</a></ul></blockquote></ul></ul></ul><h2 id="완료된-설정"><span class="mr-2">완료된 설정</span><a href="#완료된-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>상세 코드는 <a href="https://github.com/ghkdqhrbals/spring-chatting-server">https://github.com/ghkdqhrbals/spring-chatting-server</a>에서 확인하능하다.</p><blockquote><p>main branch에 존재</p></blockquote><h3 id="완료된-api-gatewaynginxconfig"><span class="mr-2">완료된 API GATEWAY(nginx.config)</span><a href="#완료된-api-gatewaynginxconfig" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre>user  nginx;
worker_processes  1;
error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
events {
    worker_connections  1024;
}
http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    upstream chat-server {
        # IP 해쉬화 하여 특정 서버에 들어가도록 설정
        # https://nginx.org/en/docs/http/ngx_http_upstream_module.html#ip_hash
        ip_hash;
        server chatting-server-1:8083;
        server chatting-server-2:8084;
    }
    upstream auth-server {
        server auth-server:8085;
    }
    server {
        listen 80;
        # 추후 server_name 변경예정
        server_name localhost;

        location / {
            # 채팅서버 backend
            location /chat {
                proxy_pass         http://chat-server;
                proxy_redirect     off;
                proxy_set_header   Host $host;
                proxy_set_header   X-Real-IP $remote_addr; # 클라이언트 요청 ip전송
                proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for; # 클라이언트 요청 ip전송
            }
            # 인증서버 backend
            location /user {
                rewrite ^([^.]*[^/])$ $1/ permanent; # tailing slash with every url
                proxy_pass         http://auth-server;
                proxy_redirect     off;
                proxy_set_header   Host $host;
                proxy_set_header   X-Real-IP $remote_addr;
                proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
            }
        }

    }
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    keepalive_timeout  65;
    include /etc/nginx/conf.d/*.conf;
}
</pre></table></code></div></div><h3 id="완료된-docker-composeyml"><span class="mr-2">완료된 Docker-compose.yml</span><a href="#완료된-docker-composeyml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Kafka 설정에 있어 <a href="https://www.confluent.io/blog/kafka-client-cannot-connect-to-broker-on-aws-on-docker-etc/">https://www.confluent.io/blog/kafka-client-cannot-connect-to-broker-on-aws-on-docker-etc/</a> 문서가 많은 도움이 되었다.</p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
</pre><td class="rouge-code"><pre>version : '2'
services:
  # -------- API GATEWAY --------
  nginx:
    restart: always
    container_name: nginx
    depends_on:
      - chatting-server-1
      - chatting-server-2
    build:
      context: ./nginx
      dockerfile: Dockerfile
    ports:
      - "8080:80"

  # -------- KAFKA --------
  zookeeper:
    image: confluentinc/cp-zookeeper:7.2.1
    container_name: zookeeper
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181
  kafka1:
    image: confluentinc/cp-kafka:7.2.1
    container_name: kafka1
    ports:
      - "8097:8097"
    depends_on:
      - zookeeper
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: EXTERNAL:PLAINTEXT,INTERNAL:PLAINTEXT
      KAFKA_ADVERTISED_LISTENERS: EXTERNAL://localhost:8097,INTERNAL://kafka1:9092
      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL
  kafka2:
    image: confluentinc/cp-kafka:7.2.1
    container_name: kafka2
    ports:
      - "8098:8098"
    depends_on:
      - zookeeper
    environment:
      KAFKA_BROKER_ID: 2
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: EXTERNAL:PLAINTEXT,INTERNAL:PLAINTEXT
      KAFKA_ADVERTISED_LISTENERS: EXTERNAL://localhost:8098,INTERNAL://kafka2:9092
      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL
  kafka3:
    image: confluentinc/cp-kafka:7.2.1
    container_name: kafka3
    ports:
      - "8099:8099"
    depends_on:
      - zookeeper
    environment:
      KAFKA_BROKER_ID: 3
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: EXTERNAL://localhost:8099,INTERNAL://kafka3:9092
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: EXTERNAL:PLAINTEXT,INTERNAL:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL

  <span class="c"># -------- Chatting Server --------</span>
  chatting-db-1:
    container_name: chatting-db-1
    image: postgres:12-alpine
    environment:
      - POSTGRES_PASSWORD=password
      - POSTGRES_USER=postgres
      - POSTGRES_DB=chat
    expose:
      - "5433" # Publishes 5433 to other containers but NOT to host machine
    ports:
      - "5433:5433"
    volumes:
      - ./backups:/home/backups
    command: -p 5433
  chatting-server-1:
    container_name: chatting-server-1
    build: ./spring-chatting-backend-server
    ports:
      - "8083:8083"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:postgresql://chatting-db-1:5433/chat
      - SPRING_DATASOURCE_USERNAME=postgres
      - SPRING_DATASOURCE_PASSWORD=password
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
      - SERVER_PORT=8083
      - KAFKA_BOOTSTRAP=kafka1:9092,kafka2:9092,kafka3:9092 <span class="c"># 내부포트</span>
    depends_on:
      - kafka1
      - kafka2
      - kafka3
      - chatting-db-1
    restart: always
  chatting-db-2:
    container_name: chatting-db-2
    image: postgres:12-alpine
    environment:
      - POSTGRES_PASSWORD=password
      - POSTGRES_USER=postgres
      - POSTGRES_DB=chat
    expose:
      - "5434" # Publishes 5433 to other containers but NOT to host machine
    ports:
      - "5434:5434"
    volumes:
      - ./backups:/home/backups
    command: -p 5434
  chatting-server-2:
    container_name: chatting-server-2
    build: ./spring-chatting-backend-server
    ports:
      - "8084:8084"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:postgresql://chatting-db-2:5434/chat
      - SPRING_DATASOURCE_USERNAME=postgres
      - SPRING_DATASOURCE_PASSWORD=password
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
      - SERVER_PORT=8084
      - KAFKA_BOOTSTRAP=kafka1:9092,kafka2:9092,kafka3:9092 <span class="c"># 내부포트</span>
    depends_on:
      - kafka1
      - kafka2
      - kafka3
      - chatting-db-2
    restart: always

  <span class="c"># -------- Authentication Server --------</span>
  auth-db:
    container_name: auth-db
    image: postgres:12-alpine
    environment:
      - POSTGRES_PASSWORD=password
      - POSTGRES_USER=postgres
      - POSTGRES_DB=auth
    expose:
      - "5435" # Publishes 5433 to other containers but NOT to host machine
    ports:
      - "5435:5435"
    volumes:
      - ./backups:/home/backups
    command: -p 5435
  auth-server:
    container_name: auth-server
    build: ./spring-auth-backend-server
    ports:
      - "8085:8085"
    environment:
      - SERVER_PORT=8085
      - SPRING_DATASOURCE_URL=jdbc:postgresql://auth-db:5435/auth
      - SPRING_DATASOURCE_USERNAME=postgres
      - SPRING_DATASOURCE_PASSWORD=password
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
    depends_on:
      - auth-db
    restart: always
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EC%B1%84%ED%8C%85%EC%84%9C%EB%B2%84-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/'>채팅서버 프로젝트</a>, <a href='/categories/%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%A7%84%ED%96%89/'>프로젝트 진행</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EC%8B%A4%EC%8B%9C%EA%B0%84+%EC%B1%84%ED%8C%85%EB%B0%A9+%EA%B5%AC%ED%98%84%287%29+-+%28%EC%88%98%EC%A0%95%EB%90%9C+%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%29+-+Austin&url=%2Fposts%2Fchatting%287%29%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EC%8B%A4%EC%8B%9C%EA%B0%84+%EC%B1%84%ED%8C%85%EB%B0%A9+%EA%B5%AC%ED%98%84%287%29+-+%28%EC%88%98%EC%A0%95%EB%90%9C+%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%29+-+Austin&u=%2Fposts%2Fchatting%287%29%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fchatting%287%29%2F&text=%EC%8B%A4%EC%8B%9C%EA%B0%84+%EC%B1%84%ED%8C%85%EB%B0%A9+%EA%B5%AC%ED%98%84%287%29+-+%28%EC%88%98%EC%A0%95%EB%90%9C+%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%29+-+Austin" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cs-information/">CS information</a> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/error/">error</a> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/msa/">msa</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/restful/">RESTFUL</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/database/">database</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/chatting(10)/"><div class="card-body"> <em class="small" data-ts="1673136025" data-df="YYYY-MM-DD" > 2023-01-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>실시간 채팅방 구현(10) - (양방향 DB Sync 구현의 어려움 + 비용)</h3><div class="text-muted small"><p> 서론 단방향까지는 구현이 가능했었는데, 양방향(BDR)은 아래의 이유로 굉장히 까다로웠다. 컨셉만 존재할 뿐, 코드 레퍼런스가 없다. 현업자분들께 방향성을 여쭙고싶다. 두 개의 마스터 노드일 때는 그래도 할 순 있겠지만, 그 이상일 때는 각각을 전부다 설정해줘야하기때문에 상당히 까다롭다. ...</p></div></div></a></div><div class="card"> <a href="/posts/chatting(11)/"><div class="card-body"> <em class="small" data-ts="1673740825" data-df="YYYY-MM-DD" > 2023-01-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>실시간 채팅방 구현(11) - (대량 Rest api test 코드)</h3><div class="text-muted small"><p> 현재까지 auth/chat Server 및 여러 장애대응과 모니터링 서비스를 구축했다. 서비스관련 테스트 코드는 이미 생성하였으며, 이제는 다량의 Rest api 트래픽을 테스트를 위한 클라이언트를 제작해 볼 차례이다. 아래의 코드는 Golang으로 제작하였다. 예상되는 아래의 질문에 대한 답변을 준비해봤다. Question : 왜 Java...</p></div></div></a></div><div class="card"> <a href="/posts/chatting(12)/"><div class="card-body"> <em class="small" data-ts="1673740825" data-df="YYYY-MM-DD" > 2023-01-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>실시간 채팅방 구현(12) - (대량 Rest api test 한계 돌파)</h3><div class="text-muted small"><p> INDEX 랜덤값으로 test하는 code 10000개 rest api 트래픽 실행(110초 소요) 이제 동시 연결가능한 TCP 소켓을 필자의 맥북이 버틸 수 있는만큼 열어서 다량의 http request를 서버로 전송해볼려고 한다. 1 2 3 4 5 6 7 8 9 10 t := http.DefaultTransport.(*http.Tr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/chatting(6)/" class="btn btn-outline-primary" prompt="이전 글"><p>실시간 채팅방 구현(6) - (전체 아키텍처 수정)</p></a> <a href="/posts/elastic-search/" class="btn btn-outline-primary" prompt="다음 글"><p>Elastic Search의 개념 및 RDB와의 차이점</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cs-information/">CS information</a> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/error/">error</a> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/msa/">msa</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/restful/">RESTFUL</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/database/">database</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ghkdqhrbals">ghkdqhrbals</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-VTR1DF5BPL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-VTR1DF5BPL'); }); </script>
