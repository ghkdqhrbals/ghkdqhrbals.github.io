<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Docker Setting" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="Dockerfile" /><meta property="og:description" content="Dockerfile" /><link rel="canonical" href="/posts/docker1/" /><meta property="og:url" content="/posts/docker1/" /><meta property="og:site_name" content="Austin" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-10T05:00:25+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Docker Setting" /><meta name="twitter:site" content="@ghkdqhrbals" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-10T05:00:25+00:00","datePublished":"2022-03-10T05:00:25+00:00","description":"Dockerfile","headline":"Docker Setting","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/docker1/"},"url":"/posts/docker1/"}</script><title>Docker Setting | Austin</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Austin"><meta name="application-name" content="Austin"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Austin</a></div><div class="site-subtitle font-italic"> Record every seconds</div><div class="site-subtitle"> <a href="https://ghkdqhrbals.github.io/portfolios/" class="mx-auto" style="color: #ffd700"> See my portfolio </a></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ghkdqhrbals" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ghkdqhrbals','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>Docker Setting</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Docker Setting</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1646888425" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-03-10 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ghkdqhrbals">ghkdqhrbals</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1079 단어"> <em>5 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="dockerfile">Dockerfile</h1><p>Below is my Banking Server backend Dockerfile. Here, I’m going to explain each steps.</p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c"># Build stage</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">golang:1.18.3-alpine3.16</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span><span class="s"> ../.. .</span>
<span class="k">RUN </span>go build <span class="nt">-o</span> main main.go
<span class="k">RUN </span>apk add curl
<span class="k">RUN </span>curl <span class="nt">-L</span> https://github.com/golang-migrate/migrate/releases/download/v4.15.2/migrate.linux-amd64.tar.gz | <span class="nb">tar </span>xvz


<span class="c"># Run stage</span>
<span class="k">FROM</span><span class="s"> alpine:3.16</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span><span class="s"> --from=builder /app/main .</span>
<span class="k">COPY</span><span class="s"> --from=builder /app/migrate ./migrate</span>
<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> bash
<span class="k">COPY</span><span class="s"> app.env .</span>
<span class="k">COPY</span><span class="s"> start.sh .</span>
<span class="k">COPY</span><span class="s"> wait-for-it.sh .</span>
<span class="k">COPY</span><span class="s"> db/migration ./migration</span>


<span class="k">EXPOSE</span><span class="s"> 8080</span>
<span class="k">CMD</span><span class="s"> ["/app/main"]</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["/app/start.sh"]</span>
</pre></table></code></div></div><p>Lets start from the beginning!</p><h2 id="build-stage"><span class="mr-2">Build Stage</span><a href="#build-stage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p><code class="language-plaintext highlighter-rouge">FROM golang:1.18.3-alpine3.16 AS builder</code> First, alpine is small version of linux. They dont have bash, curl or other libraries. So for me, I need only golang environment and basic linux. Thus this compact version of linux fits to me.</p><li><p><code class="language-plaintext highlighter-rouge">WORKDIR /app</code>,<code class="language-plaintext highlighter-rouge">COPY . .</code> Set my local environment in <code class="language-plaintext highlighter-rouge">/app</code>.</p><li><p><code class="language-plaintext highlighter-rouge">RUN go build -o main main.go</code> run <code class="language-plaintext highlighter-rouge">go build -o main main.go</code> in docker container terminal. This command help me to get a compiled version of excutable file:main</p><li><p><code class="language-plaintext highlighter-rouge">RUN apk add curl</code> As I said before, in alpine version, there is no curl inside. So we need to install curl for download from github.</p><li><p><code class="language-plaintext highlighter-rouge">RUN curl -L https://github.com/golang-migrate/migrate/releases/download/v4.15.2/migrate.linux-amd64.tar.gz | tar xvz</code> I’m going to install golang-migrate to use <code class="language-plaintext highlighter-rouge">migrate</code> command tools for migration. So install and decompress files. the <code class="language-plaintext highlighter-rouge">-L</code> option means that redirect to location.</p></ul><p>The purpose of this build stage is that literally building basic environments. Now its <strong>Run Stage</strong>.</p><h2 id="build-stage-1"><span class="mr-2">Build Stage</span><a href="#build-stage-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p><code class="language-plaintext highlighter-rouge">FROM alpine:3.16</code> <code class="language-plaintext highlighter-rouge">WORKDIR /app</code> Basic Linux and Setting up.</p><li><p><code class="language-plaintext highlighter-rouge">COPY --from=builder /app/main .</code> In build stage, we will copy executable file main into <code class="language-plaintext highlighter-rouge">/app</code></p><li><p><code class="language-plaintext highlighter-rouge">COPY --from=builder /app/migrate ./migrate</code> Also we will copy migrates(.exe) which is generated from <code class="language-plaintext highlighter-rouge">curl -L github.~~~</code>.</p><li><p><code class="language-plaintext highlighter-rouge">RUN apk add --no-cache bash</code> alpine image doesn’t have bash, so I will install that. I will use bash for run shell scripts.</p><li><p><code class="language-plaintext highlighter-rouge">COPY app.env .</code> <code class="language-plaintext highlighter-rouge">app.env</code> contains server configuration like below. From this environment files, I use Viper library to automatically set configuration on server. But, only use Viper as local testing.</p></ul><div file="app.env" class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="app.env"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="s">DB_DRIVER=postgres</span>
<span class="s">DB_SOURCE=postgresql://root:secret@localhost:5432/simple_bank?sslmode=disable</span>
<span class="s">SERVER_ADDRESS=0.0.0.0:8080</span>
<span class="s">ACCESS_TOKEN_DURATION=15m</span>
<span class="s">TOKEN_SYMMETRIC_KEY=12345678901234567890123456789012</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">COPY start.sh .</code> I use <code class="language-plaintext highlighter-rouge">start.sh</code> to run db migration to my database and start the app.</ul><div file="start.sh" class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="start.sh"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>
<span class="nb">set</span> <span class="nt">-e</span>
<span class="nb">echo</span> <span class="s2">"run db migration"</span>
/app/migrate <span class="nt">-path</span> /app/migration <span class="nt">-database</span> <span class="s2">"</span><span class="nv">$DB_SOURCE</span><span class="s2">"</span> <span class="nt">-verbose</span> up
<span class="nb">echo</span> <span class="s2">"start the app"</span>
<span class="nb">exec</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">COPY wait-for-it.sh .</code> As I use two containers, Postgres and Backend-Service, my service needs to wait until Postgres container is ready. This shell script listen port 5432, so can decide whethere this port is ready. This file is long so you can check my github.</p><li><p><code class="language-plaintext highlighter-rouge">COPY db/migration ./migration</code> <code class="language-plaintext highlighter-rouge">start.sh</code> generate SQL queries for migration in <code class="language-plaintext highlighter-rouge">db/migration</code>, and I will copy these schemes into <code class="language-plaintext highlighter-rouge">/migration</code></p><li><p><code class="language-plaintext highlighter-rouge">EXPOSE 8080</code> I will expose this service locally with port <code class="language-plaintext highlighter-rouge">8080</code>.</p><li><p><code class="language-plaintext highlighter-rouge">CMD ["/app/main"]</code> Set <code class="language-plaintext highlighter-rouge">/app/main</code> as a default command.</p><li><p>ENTRYPOINT [“/app/start.sh”] When this Dockerfile build &amp; run in container, <code class="language-plaintext highlighter-rouge">/app/start.sh</code> will be executed <strong>first</strong>.</p></ul><h1 id="docker-compose">docker-compose</h1><ul><li>Docker compose simplifies management by automatically building and executing services from <strong>multiple containers</strong>. Below is my setting for composing docker containers.<blockquote><p>like kubernetes</p></blockquote></ul><div file="docker-compose.yml" class="language-yml highlighter-rouge"><div class="code-header"> <span data-label-text="docker-compose.yml"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="na">services</span><span class="pi">:</span>
  <span class="na">postgres</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">postgres:12-alpine</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">POSTGRES_USER=root</span>
      <span class="pi">-</span> <span class="s">POSTGRES_PASSWORD=secret</span>
      <span class="pi">-</span> <span class="s">POSTGRES_DB=simple_bank</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5432:5432"</span> <span class="c1"># purpose to exposeing ports. Except this ports, you can use only inside services</span>
  <span class="na">api</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span>
      <span class="na">context</span><span class="pi">:</span> <span class="s">.</span>
      <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080:8080"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">DB_SOURCE=postgresql://root:secret@postgres:5432/simple_bank?sslmode=disable</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">postgres</span>
    <span class="na">entrypoint</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/app/wait-for-it.sh"</span><span class="pi">,</span><span class="s2">"</span><span class="s">postgres:5432"</span><span class="pi">,</span><span class="s2">"</span><span class="s">--"</span><span class="pi">,</span><span class="s2">"</span><span class="s">/app/start.sh"</span><span class="pi">]</span>
    <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/app/main"</span><span class="pi">]</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">services:</code> Declare that we are going to setting containers.<li><code class="language-plaintext highlighter-rouge">postgres:</code> This service name &amp; container name.<li><p><code class="language-plaintext highlighter-rouge">image: postgres:12-alpine</code> We now get image of postgres from dockerhub.</p><li><p><code class="language-plaintext highlighter-rouge">environment: - POSTGRES_USER=root - POSTGRES_PASSWORD=secret - POSTGRES_DB=simple_bank</code> Setting user, password, db name.</p><li><code class="language-plaintext highlighter-rouge">ports:</code> Just for here, we will expose port outside.<li><code class="language-plaintext highlighter-rouge">api</code>, <code class="language-plaintext highlighter-rouge">build</code>, <code class="language-plaintext highlighter-rouge">context: .</code>, <code class="language-plaintext highlighter-rouge">dockerfile: Dockerfile</code> We will build image with Dockerfile in this folder.<li><code class="language-plaintext highlighter-rouge">ports: - "8080:8080"</code> Normally, backend server’s port doesn’t need to show their ports outside.</ul><blockquote class="prompt-danger"><div><p>Actually, It is critical when you expose Postgres ports outside. Because malicious users can access to server’s DB and take out all informations. Also it is very vulnerable to DoS/DDoS attack(<strong>especially low-rate DoS Attack</strong>).</p></div></blockquote><ul><li><p><code class="language-plaintext highlighter-rouge">environment: - DB_SOURCE=~~~</code> Setting Env. Instead of <code class="language-plaintext highlighter-rouge">secret@localhost</code>, set as <code class="language-plaintext highlighter-rouge">secret@postgres</code> so postgres service’s network will be fitted. Generate services using docker compose will seperate <code class="language-plaintext highlighter-rouge">postgres</code> service and <code class="language-plaintext highlighter-rouge">api</code> service as a different IP address like <code class="language-plaintext highlighter-rouge">postgres</code>=’172.16.0.<strong>2</strong>’,<code class="language-plaintext highlighter-rouge">api</code>=’172.16.0.<strong>3</strong>’. So <code class="language-plaintext highlighter-rouge">secret@localhost</code> means <code class="language-plaintext highlighter-rouge">secret@172.16.0.3</code>. But it should be <code class="language-plaintext highlighter-rouge">secret@172.16.0.2</code>. So rather set <code class="language-plaintext highlighter-rouge">secret@172.16.0.2</code>, you can just set a service name there.</p><li><p><code class="language-plaintext highlighter-rouge">depends_on: - postgres</code> api service will need postgres service. So After postgres service is running, api service will run.</p><li><p><code class="language-plaintext highlighter-rouge">entrypoint: ["/app/wait-for-it.sh","postgres:5432","--","/app/start.sh"]</code> First, run <code class="language-plaintext highlighter-rouge">/app/wait-for-it.sh</code>, so set listening port for postgres server. Second, set <code class="language-plaintext highlighter-rouge">postgres:5432</code> as a argument of <code class="language-plaintext highlighter-rouge">wait-for-it.sh</code>. Lastly, all things ready, start <code class="language-plaintext highlighter-rouge">start.sh</code></p></ul><p>Before</p><div file="terminal" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="terminal"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>gyuminhwangbo@Gyuminui-MacBookPro simplebank % docker images
REPOSITORY   TAG                 IMAGE ID       CREATED        SIZE
</pre></table></code></div></div><p>After</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre>gyuminhwangbo@Gyuminui-MacBookPro simplebank % docker compose up
...
gyuminhwangbo@Gyuminui-MacBookPro simplebank % docker images
REPOSITORY       TAG                 IMAGE ID       CREATED        SIZE
simplebank_api   latest              7da6148aa0f0   3 weeks ago    52.1MB

gyuminhwangbo@Gyuminui-MacBookPro simplebank % docker ps -a
CONTAINER ID   IMAGE                COMMAND                  CREATED          STATUS          PORTS                    NAMES
de0dfecaf757   simplebank_api       "/app/wait-for-it.sh…"   47 seconds ago   Up 45 seconds   0.0.0.0:8080-&gt;8080/tcp   simplebank-api-1
5a9c72502355   postgres:12-alpine   "docker-entrypoint.s…"   47 seconds ago   Up 45 seconds   0.0.0.0:5432-&gt;5432/tcp   simplebank-postgres-1

gyuminhwangbo@Gyuminui-MacBookPro simplebank % docker network inspect simplebank_default
[
    {
        "Name": "simplebank_default",
        "Id": "8e834d593f880a08051e480628d94b0c61c91964a0e7d76c1e63ae249140193f",
        "Created": "2022-07-23T08:03:57.59455131Z",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": null,
            "Config": [
                {
                    "Subnet": "192.168.96.0/20",
                    "Gateway": "192.168.96.1"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {
            "5a9c72502355f346543b02b0ba1a89563333f2c3d5450da25e68f6c8c32a14f9": {
                "Name": "simplebank-postgres-1",
                "EndpointID": "08fdd10da2e5d6ba2b5b9b7b69aebab0797c1e5fd2c24ce5a9a0f2be96aaa4e1",
                "MacAddress": "02:42:c0:a8:60:02",
                "IPv4Address": "192.168.96.2/20",
                "IPv6Address": ""
            },
            "de0dfecaf75713dbc30595e21cf978472919d6bce9101acba36ab49708fa53cd": {
                "Name": "simplebank-api-1",
                "EndpointID": "b969560e4d29bcf7cbfbbaf67d524215704919ae5720ce40befbbe7ebc19fb1a",
                "MacAddress": "02:42:c0:a8:60:03",
                "IPv4Address": "192.168.96.3/20",
                "IPv6Address": ""
            }
        },
        "Options": {},
        "Labels": {
            "com.docker.compose.network": "default",
            "com.docker.compose.project": "simplebank",
            "com.docker.compose.version": "2.4.1"
        }
    }
]
</pre></table></code></div></div><p>By sending HTTP request using Postman, results are below.</p><h3 id="login"><span class="mr-2">Login</span><a href="#login" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Register <code class="language-plaintext highlighter-rouge">ghkdqhrbals</code> <img data-src="../../assets/p/2/register_non.png" alt="i" data-proofer-ignore></p><li><p>Register again with <code class="language-plaintext highlighter-rouge">ghkdqhrbals</code> and here is violations! <img data-src="../../assets/p/2/register_violation.png" alt="i" data-proofer-ignore></p><li><p>Register <code class="language-plaintext highlighter-rouge">Kim</code> <img data-src="../../assets/p/2/register.png" alt="i" data-proofer-ignore></p><li><p>Login <code class="language-plaintext highlighter-rouge">Kim</code> <img data-src="../../assets/p/2/login.png" alt="i" data-proofer-ignore></p><li><p>Both <code class="language-plaintext highlighter-rouge">ghkdqhrbals</code>, <code class="language-plaintext highlighter-rouge">Kim</code>’s register informations are successfully stored in postgres database. <img data-src="../../assets/p/2/db_table.png" alt="i" data-proofer-ignore></p></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EC%84%9C%EB%B2%84/'>서버</a>, <a href='/categories/docker/'>Docker</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/golang/" class="post-tag no-text-decoration" >golang</a> <a href="/tags/backend/" class="post-tag no-text-decoration" >backend</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Docker+Setting+-+Austin&url=%2Fposts%2Fdocker1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Docker+Setting+-+Austin&u=%2Fposts%2Fdocker1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fdocker1%2F&text=Docker+Setting+-+Austin" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cs-information/">CS information</a> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/error/">error</a> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/msa/">msa</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/restful/">RESTFUL</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/database/">database</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/docker2/"><div class="card-body"> <em class="small" data-ts="1647147625" data-df="YYYY-MM-DD" > 2022-03-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker vs Virtual Machine</h3><div class="text-muted small"><p> Main difference between Docker and VM Size VM : large size To execute program, VM needs to have GuestOS which is very large size Docker : smal...</p></div></div></a></div><div class="card"> <a href="/posts/golang-backend(1)/"><div class="card-body"> <em class="small" data-ts="1643749225" data-df="YYYY-MM-DD" > 2022-02-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How can we generate golang interface from SQL queries?</h3><div class="text-muted small"><p> Database design First I’m going to write DB scheme using dbdiagram. We can make general sql code as below. Table users as U{ username varchar [pk] hased_password varchar [not null] full_...</p></div></div></a></div><div class="card"> <a href="/posts/golang-backend(3)/"><div class="card-body"> <em class="small" data-ts="1650693625" data-df="YYYY-MM-DD" > 2022-04-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Banking backend server with Golang(Done)</h3><div class="text-muted small"><p> Progress For my experience in golang-backend, I use below skills for develop my banking service. You can see the source code in my github. Banking backend server Skills Skills...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/network(3)/" class="btn btn-outline-primary" prompt="이전 글"><p>Network-3:TLS 1.2 vs TLS 1.3</p></a> <a href="/posts/docker2/" class="btn btn-outline-primary" prompt="다음 글"><p>Docker vs Virtual Machine</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cs-information/">CS information</a> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/error/">error</a> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/msa/">msa</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/restful/">RESTFUL</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/database/">database</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ghkdqhrbals">ghkdqhrbals</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-VTR1DF5BPL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-VTR1DF5BPL'); }); </script>
